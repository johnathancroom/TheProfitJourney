<% content_for :body_content_title do %>
  <%= "Sign Up for #{@workshop.title}" %>
<% end %>
<% content_for :title do %>
  <%= "Sign Up for #{@workshop.title}" %>
<% end %>

<% content_for :body do %>
  <%= render 'details' %>

  <%= form_for @user, :url => refinery.signup_workshops_workshop_path, :html => { :method => "PUT", :class => "workshop_signup" } do |f| %>
    <% if @user.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@user.errors.count, "error") %> need to be corrected before continuing:</h2>

        <ul>
        <% @user.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <h1>User Information</h1>
    <div>
      <%= f.label :username %>
      <%= f.text_field :username %>
    </div>

    <div>
      <%= f.label :email %>
      <%= f.email_field :email %>
    </div>

    <div>
      <%= f.label :password %>
      <%= f.password_field :password %>
    </div>

    <hr>

    <% if !@transaction_error.nil? %>
      <div id="error_explanation">
        <h2>1 error needs to be corrected before continuing:</h2>
        <ul>
          <%= content_tag :li, @transaction_error %>
        </ul>
      </div>
    <% end %>

    <h1>Payment Information</h1>
    <div>
      <%= label_tag :card_number %>
      <%= text_field_tag :card_number, "4222222222222", :autocomplete => "off", :size => 30 %>
    </div>

    <div>
      <%= label_tag :card_expiration %>
      <%= select_tag :card_expiry_month, options_for_select(@months, 11) %>
      <%= select_tag :card_expiry_year, options_for_select(@years, 2014) %>
    </div>

    <%= f.submit "Sign Up & Submit Payment", :class => "signup" %>
    <%= content_tag :span, "Submitting will charge your credit card #{number_to_currency @workshop.price} immediately.", :class => "payment_notice" %>
  <% end %>
<% end %>

<%= render '/refinery/content_page' %>
